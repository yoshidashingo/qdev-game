# エキサイトバイク 詳細仕様書（改訂版）

## ゲーム概要
エキサイトバイクは、プレイヤーがオフロードバイクを操作し、横スクロールする地形を走行しながら障害物を避けたりジャンプしたりするゲームです。プレイヤーの目標は、できるだけ長い距離を走行し、高いスコアを獲得することです。

## 基本仕様

### ゲームキャンバス
- 幅: 800px
- 高さ: 400px
- 背景: 空、山、地形の多層構造

### プレイヤー（バイク）
- **デザイン**: リアルなオフロードバイクのシルエットと詳細を持つスプライト
- サイズ: 幅80px、高さ50px
- 初期位置: x=100, y=300（地面の上）
- 速度範囲: 0〜15（通常最大）、ターボ使用時は最大22.5
- 加速度: 0.3/フレーム（より素早い反応）
- 減速度: 0.15/フレーム
- 重力: 0.6/フレーム（より現実的な落下）
- ジャンプ力: -12（より高いジャンプ）
- **アニメーション**: 
  - 走行時のエンジン振動
  - ジャンプ時の傾き
  - 着地時の衝撃吸収
  - ターボ時の特殊エフェクト

### 障害物
- 種類:
  1. 小型障害物: 岩、倒木（幅30-40px、高さ20-30px）
  2. 中型障害物: 低い壁、水たまり（幅50-60px、高さ30-40px）
  3. 大型障害物: 高い壁、大きな岩（幅70-80px、高さ40-50px）
  4. 長い障害物: 泥沼、砂地（幅100-120px、高さ20-30px）
  5. 高い障害物: フェンス、看板（幅40-50px、高さ60-70px）
  6. ランプ: ジャンプ台（幅60-70px、高さ20-30px）

- **デザイン**: 各障害物は明確に識別できる視覚的デザイン
- **配置**: 
  - 障害物は常に画面内に少なくとも1-2個存在するよう調整
  - 難易度に応じたパターン配置（初級、中級、上級）
  - プレイヤーの速度に応じた間隔調整
- **衝突判定**: 
  - バイクと障害物の形状に合わせた精密な判定
  - 視覚的に一致する衝突境界

### 地形
- 基本地形: 平坦な地面
- 特殊地形:
  - 丘陵（上り下り）
  - 凹凸の激しい地形
  - 砂地（減速効果）
  - 舗装路（加速効果）

### ゲームメカニクス

#### 移動と操作
- 右矢印キー: 加速（押し続けると継続的に加速）
- 左矢印キー: 減速（押し続けると継続的に減速）
- 上矢印キー: ジャンプ（タイミングが重要）
- 下矢印キー: しゃがむ（低い障害物をくぐる）
- スペースキー: ターボ（一時的に加速度が2倍になるが、制御が難しくなる）

#### ジャンプ
- ジャンプ中はバイクが前傾
- 着地時は衝撃吸収アニメーション
- 地形の高低差に応じたジャンプ高さの調整
- ランプに乗ると自動的に高くジャンプ

#### しゃがみ
- しゃがみ中はバイクのライダーが低く姿勢を変える
- 高速移動中のしゃがみは安定性が増す

#### 衝突と障害物
- 障害物との衝突は視覚的にフィードバック（振動、閃光）
- 障害物の種類によって異なる衝突効果
- 小さな障害物は減速のみ
- 大きな障害物は転倒してゲームオーバー

### 視覚効果
- ダイナミックな背景パララックス
- バイクの排気ガスエフェクト
- 砂埃や泥はねエフェクト
- ターボ使用時の炎のエフェクト
- 衝突時の衝撃波エフェクト
- 日中から夕方への時間経過による背景変化

### サウンド（将来の拡張）
- エンジン音（速度に応じて変化）
- ジャンプ、着地音
- 衝突音
- 背景音楽

### スコアとタイマー
- スコア: 走行距離と技術点（ジャンプ、障害物回避）に基づいて計算
- タイム: ゲーム開始からの経過時間（分:秒）
- 速度表示: 現在の速度×10 km/h

### コンボシステム
#### コンボアクション
以下のアクションでコンボが発生:
- ジャンプ成功（着地時にカウント）
- 障害物の回避（近接通過）
- ランプからのジャンプ
- ターボでの障害物回避

#### コンボ倍率
- 基本倍率: 1.0x
- 2連続: 1.5x
- 3連続: 2.0x
- 4連続: 2.5x
- 5連続以上: 3.0x

#### コンボタイミング
- コンボ継続時間: 3秒
- 次のアクションまでの制限時間: 3秒
- 制限時間を超えるとコンボリセット

#### 視覚的フィードバック
- コンボカウンター表示（画面右上）
- コンボ達成時のエフェクト
  - 数字が大きくなるアニメーション
  - 光のエフェクト
  - パーティクル効果
- コンボ終了時の演出
  - フェードアウト
  - 獲得スコアの表示

### ゲーム状態
- 未開始: スタート画面表示
- プレイ中: ゲームが進行中
- 一時停止: ゲームが一時停止
- ゲームオーバー: 障害物に衝突した状態

## 修正が必要な問題点

### 1. バイクのデザインと挙動
- **問題**: 現在のバイクは単純な矩形で、オフロードバイクらしさがない
- **解決策**: 
  - バイクのスプライトを詳細なデザインに変更
  - 走行、ジャンプ、しゃがみ時の異なるアニメーションフレーム
  - 物理挙動の調整（重力、加速度、ジャンプ力）

### 2. 障害物の存在感と配置
- **問題**: 障害物が少なく、回避する必要性が低い
- **解決策**:
  - 障害物の出現頻度を増加
  - 障害物のデザインを明確に識別できるよう改善
  - 障害物パターンの導入（初級、中級、上級）
  - 障害物の配置アルゴリズムの改善

### 3. ゲームの難易度
- **問題**: ゲームが簡単すぎて挑戦性がない
- **解決策**:
  - 速度に応じた障害物の出現頻度調整
  - 複合的な障害物パターンの導入
  - 地形の変化による難易度の変動
  - 時間経過とともに難易度が上昇するシステム

### 4. 視覚的フィードバック
- **問題**: 衝突や行動に対するフィードバックが不足
- **解決策**:
  - 衝突時の画面振動効果
  - ジャンプ、着地時のエフェクト追加
  - スコア獲得時の視覚的強調
  - 障害物との距離に応じた警告表示

### 5. ゲームの没入感
- **問題**: 背景が単調で没入感が低い
- **解決策**:
  - 多層パララックス背景の実装
  - 時間経過による背景の変化
  - 環境エフェクト（砂埃、雲の動き）
  - 走行距離に応じた地形の変化

## 実装優先順位

1. **バイクのデザインと物理挙動の改善**
   - バイクのスプライト改善
   - 物理パラメータの調整
   - アニメーションの追加

2. **障害物システムの強化**
   - 障害物の出現頻度と配置の改善
   - 障害物デザインの強化
   - 衝突判定の精度向上

3. **視覚効果の強化**
   - 背景のパララックス効果
   - エフェクト（排気ガス、砂埃）
   - 衝突時のフィードバック

4. **ゲームバランスの調整**
   - 難易度の段階的上昇
   - スコアシステムの改善
   - コンボシステムの導入

5. **UI/UXの改善**
   - ゲーム状態の明確な表示
   - チュートリアル要素
   - 視覚的なガイダンス
